<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Simple translator</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.23/jquery-ui.min.js"></script>
  </head>
  <style>
    <!--
    .ui-selected {
      background: gray;
    }
    #select-text li {
      padding-right: 10px;
    }
    #trs {
      height: 25px;
      width: 600px;
      border-width: 0;
    }
    -->
  </style>
  <script type="text/javascript">
<!--
$(document).ready(
  function () {
  $("#source-text").keypress(
    function () {
      $("#select-text").html(
        parser($("#source-text").val()));
      
      $("#select-text").selectable({
        selected: function () {
          make_translation($(".ui-selected").html()); 
        }});

    });
  });

function parser(source) {
  var res = "";
  var source_array = source.split("\n");
  for (var i in source_array) {
    if (source_array[i])
      res += "<li>"+source_array[i]+"</li>";
  }
  return res;
}

function make_translation(request_word) {
  $("#trs").remove();
  $("#hidden").html(
    "<iframe scrolling=no id=trs src=\"http://translate.google.com/translate_a/t?client=t&text="
    + request_word + 
    "&hl=ru&sl=en&tl=ru&ie=UTF-8&oe=UTF-8&multires=1&otf=2&ssel=0&tsel=0&sc=1\"></iframe>");  
  console.log($("#trs").contents().find("pre").val());
}
-->
  </script>
  <body>
    <div id="wrap"> 
      <textarea id="source-text"></textarea>
      EN - RU Multi Translate
      <hr>
      <ul id="select-text" style="float:left"></ul>
      <div>
        <div id="hidden"></div>
        <div id="translation"></div>
        <div id="statistic"></div>
      </div>
    <div>
  </body>
</html>
